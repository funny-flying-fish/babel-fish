<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Converter</title>
    <script src="vendor/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="layout">
        <div class="main-column">
    <a href="export.html" style="display: inline-block; margin-bottom: 16px; color: #4da6ff; text-decoration: none;">→ Lokalise Export</a>

    <div class="section">
        <h2>XLSX → TXT</h2>
        <div class="form-row">
            <input type="file" id="xlsxInput" accept=".xlsx">
            <label for="xlsxOutputEncoding">Encoding:</label>
            <select id="xlsxOutputEncoding">
                <option value="macintosh" selected>Mac Roman</option>
                <option value="utf-8">UTF-8</option>
                <option value="windows-1252">Windows-1252</option>
            </select>
            <button id="xlsxToTxtBtn" disabled>Convert</button>
        </div>
        <div class="download-area" id="txtDownload"></div>
        <div class="error" id="xlsxError"></div>
    </div>

    <ul class="note-list">
        <li>Double spaces will be removed.</li>
        <li>Line breaks will be removed.</li>
        <li>The conversion date (YY-MM-DD) will be added automatically and will serve as the print material version.</li>
        <li><label><input type="checkbox" id="ruleNumeric" checked> Numeric formatting</label></li>
        <li><label><input type="checkbox" id="ruleUnitSpacing" checked> Unit spacing</label></li>
        <li><label><input type="checkbox" id="ruleUnitCase" checked> Unit case normalization</label></li>
        <li><label><input type="checkbox" id="ruleStripQuotes" checked> Strip outer quotes</label></li>
        <li><label><input type="checkbox" id="ruleGlobal" checked> Global rules</label></li>
        <li><label><input type="checkbox" id="ruleLanguage" checked> Language rules</label></li>
        <li><button type="button" class="link-button" id="openRules">More information</button></li>
    </ul>

    <div class="modal-overlay" id="rulesModal" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="rulesTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="rulesTitle">NBSP Rules</h3>
                <button type="button" class="modal-close" id="closeRules" aria-label="Close">✕</button>
            </div>
            <div class="modal-body" id="rulesContent">Loading...</div>
        </div>
    </div>
    
    <div class="section">
        <h2>TXT → XLSX</h2>
        <div class="form-row">
            <input type="file" id="txtInput" accept=".txt">
            <label for="txtInputEncoding">Encoding:</label>
            <select id="txtInputEncoding">
                <option value="macintosh" selected>Mac Roman</option>
                <option value="utf-8">UTF-8</option>
                <option value="windows-1252">Windows-1252</option>
            </select>
            <button id="txtToXlsxBtn" disabled>Convert</button>
        </div>
        <div class="download-area" id="xlsxDownload"></div>
        <div class="error" id="txtError"></div>
    </div>

    <ul class="note-list">
        <li>The Date column will be removed during conversion.</li>
        <li><label><input type="checkbox" id="ruleNumericTxt" checked> Numeric formatting</label></li>
        <li><label><input type="checkbox" id="ruleUnitSpacingTxt" checked> Unit spacing</label></li>
        <li><label><input type="checkbox" id="ruleUnitCaseTxt" checked> Unit case normalization</label></li>
        <li><label><input type="checkbox" id="ruleStripQuotesTxt" checked> Strip outer quotes</label></li>
        <li><label><input type="checkbox" id="ruleGlobalTxt" checked> Global rules</label></li>
        <li><label><input type="checkbox" id="ruleLanguageTxt" checked> Language rules</label></li>
    </ul>

    <p class="note">Default encoding is Mac Roman. If you notice character issues in the output, please try a different encoding option.</p>
        </div>
        <aside class="log-panel">
            <div class="section">
                <div class="log-header">
                    <h2 id="logTitle">Conversion log</h2>
                    <span class="log-count" id="logCount">0 changes</span>
                </div>
                <p class="log-empty" id="logEmpty">No changes yet.</p>
                <ol class="log-list" id="logList"></ol>
            </div>
        </aside>
    </div>

    <script src="converter.js"></script>
</body>
</html>

