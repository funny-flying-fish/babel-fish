Применение в конвертере
- Правила применяются только при конвертации XLSX → TXT.
- Обработка идёт для всех ячеек, кроме первой колонки (ключа).
- Код языка берётся из первой колонки после преобразования en_EN → EN.

Правила обработки пробелов (NBSP)
Порядок: числовое форматирование → пробелы перед единицами → нормализация регистра единиц → глобальные правила → правила конкретного языка.

1 Числовое форматирование (можно отключить)
1.1 Проценты (%)
- EN: строго слитно с числом (10%).
- FR/DE/ES/NL и прочие: неразрывный пробел между числом и % (10 %).

1.2 Валюты (€,$,£)
- EN и NL: символ стоит перед числом (EN без пробела: $100, NL с NBSP: € 100).
- FR/DE/ES: символ стоит после числа с NBSP (100 €).

1.3 Разделитель тысяч
- EN: запятая (1,234).
- FR: NBSP (1 234).
- DE/ES/NL: точка (1.234).

1.4 Десятичный разделитель
- EN: точка (0.136).
- FR/DE/ES/NL: запятая (0,136).

2 Пробелы перед единицами (можно отключить)
- Единицы мощности: W, kW, MW, GW, hp, PS, CV → между числом и единицей ставится NBSP (если пробела не было, он вставляется).
- Электрика: V, kV, mV, A, mA, Hz, kHz, MHz, GHz, Ohm, Ω → NBSP между числом и единицей.
- Энергия и ёмкость: Wh, kWh, MWh, J, kJ, F, µF/μF, nF → NBSP между числом и единицей.
- Сила и давление: N, kN, Kgf/kgf, Pa, kPa, bar, Nm → NBSP между числом и единицей.
- Сложные единицы: kg/h/N, m/s2 и другие комбинации вида A/B, A.B → NBSP между числом и единицей (вставляется даже если пробела не было).
- Метрические меры: km, m, cm, mm, kg, g, mg, l, ml → NBSP между числом и единицей.

3 Нормализация регистра единиц (можно отключить)
Приводит регистр символов единиц к стандартам ISO/СИ. Применяется только в связках «число + единица».

3.1 Мощность
- W, kW, MW, GW, hp, PS, CV.

3.2 Электрика
- V, kV, mV, A, mA, Hz, kHz, MHz, GHz, Ohm, Ω.

3.3 Энергия и ёмкость
- Wh, kWh, MWh, J, kJ, F, μF, nF.

3.4 Сила и давление
- N, kN, kgf, Pa, kPa, bar, Nm.

3.5 Метрические меры
- km, m, cm, mm, kg, g, mg, l, ml.

3.6 Сложные единицы
- kg/h/N, m/s².

4 Глобальные правила (для всех языков)
- Инициалы и фамилии: J. Doe, A. Einstein → пробел после инициалов заменяется на NBSP.
- Сокращения и числительные: p. 42, № 10, Vol. 3 → пробел после сокращения заменяется на NBSP.
- Даты (англ. формат): Jan 15, 2026 year → пробел между месяцем и числом, а также между годом и словом year заменяется на NBSP.

5 Правила конкретного языка

5.1 Английский (EN)
- Артикли и личное местоимение: a, an, the, I → пробел после этих слов заменяется на NBSP.

5.2 Французский (FR)
- Короткие предлоги и артикли: à, y, en, le, la, les, un, une, de, du → пробел после этих слов заменяется на NBSP.
- Пунктуация: перед ; : ! ? всегда ставится NBSP (если пробела не было — он вставляется).
- Кавычки-ёлочки: « текст » → NBSP после « и перед » (если пробела не было — он вставляется).

5.3 Испанский (ES)
- Однобуквенные союзы и предлоги, артикли: a, e, i, o, u, y, la, el, un → пробел после этих слов заменяется на NBSP.

5.4 Немецкий (DE)
- Артикли и слова-связки: der, die, das, ein, eine → пробел после этих слов заменяется на NBSP.
- Титулы: Dr., Prof., Hr., Fr. → пробел после титула заменяется на NBSP.

5.5 Голландский (NL)
- Короткие артикли и предлоги: de, het, een, in, op, te, ten, ter → пробел после этих слов заменяется на NBSP.

